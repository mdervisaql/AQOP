import{j as n}from"./query-vendor-CG4xf7JE.js";import{r as N,h as St,f as Et,L as vt}from"./react-vendor-Ch0kAUMy.js";import{g as Te,a as Le,b as ke,c as Rt,d as At,e as Ct,u as Ot,f as _t}from"./leads-CQ_k3CbU.js";import{f as $}from"./helpers-Os691a1s.js";import{L as Ge,u as Tt}from"./index-DcCoICHm.js";import{N as Lt}from"./Navigation-B2sBVjrF.js";import{a as kt,b as Ft}from"./communications-XQojI1Lv.js";function Pt({leadId:e,onAdd:t,onCancel:r}){const[s,a]=N.useState("call"),[i,o]=N.useState("outbound"),[c,m]=N.useState(""),[d,u]=N.useState(""),[p,j]=N.useState(""),[S,f]=N.useState(""),[g,h]=N.useState(""),[b,O]=N.useState(""),[v,R]=N.useState(!1),T=async E=>{if(E.preventDefault(),!!d.trim()){R(!0);try{const C={type:s,direction:i,subject:c,content:d,outcome:p,duration_seconds:S?parseInt(S)*60:null,follow_up_date:g||null,follow_up_note:b||null};await kt(e,C),t()}catch(C){console.error("Failed to add communication:",C),alert("Failed to save communication log.")}finally{R(!1)}}};return n.jsxs("form",{onSubmit:T,className:"bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Log Communication"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),n.jsxs("select",{value:s,onChange:E=>a(E.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[n.jsx("option",{value:"call",children:"ðŸ“ž Call"}),n.jsx("option",{value:"whatsapp",children:"ðŸ“± WhatsApp"}),n.jsx("option",{value:"email",children:"ðŸ“§ Email"}),n.jsx("option",{value:"sms",children:"ðŸ’¬ SMS"}),n.jsx("option",{value:"meeting",children:"ðŸ¤ Meeting"}),n.jsx("option",{value:"note",children:"ðŸ“ Note"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direction"}),n.jsxs("select",{value:i,onChange:E=>o(E.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[n.jsx("option",{value:"outbound",children:"Outbound (We contacted them)"}),n.jsx("option",{value:"inbound",children:"Inbound (They contacted us)"})]})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject / Summary"}),n.jsx("input",{type:"text",value:c,onChange:E=>m(E.target.value),placeholder:"Brief summary...",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Details"}),n.jsx("textarea",{value:d,onChange:E=>u(E.target.value),rows:3,required:!0,placeholder:"What was discussed?",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Outcome"}),n.jsxs("select",{value:p,onChange:E=>j(E.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Outcome..."}),n.jsx("option",{value:"answered",children:"Answered"}),n.jsx("option",{value:"no_answer",children:"No Answer"}),n.jsx("option",{value:"busy",children:"Busy"}),n.jsx("option",{value:"voicemail",children:"Voicemail"}),n.jsx("option",{value:"interested",children:"Interested"}),n.jsx("option",{value:"not_interested",children:"Not Interested"}),n.jsx("option",{value:"callback",children:"Callback Requested"}),n.jsx("option",{value:"completed",children:"Completed"})]})]}),s==="call"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (minutes)"}),n.jsx("input",{type:"number",min:"0",value:S,onChange:E=>f(E.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),n.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Schedule Follow-up (Optional)"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date & Time"}),n.jsx("input",{type:"datetime-local",value:g,onChange:E=>h(E.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Note"}),n.jsx("input",{type:"text",value:b,onChange:E=>O(E.target.value),placeholder:"What to do next?",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[n.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:v?"Saving...":"Save Log"})]})]})}const Ut={call:"ðŸ“ž",whatsapp:"ðŸ“±",email:"ðŸ“§",sms:"ðŸ’¬",meeting:"ðŸ¤",note:"ðŸ“"},Dt={interested:"bg-green-100 text-green-800",not_interested:"bg-red-100 text-red-800",callback:"bg-yellow-100 text-yellow-800",completed:"bg-blue-100 text-blue-800",no_answer:"bg-gray-100 text-gray-800",busy:"bg-gray-100 text-gray-800",voicemail:"bg-gray-100 text-gray-800",answered:"bg-blue-50 text-blue-600"};function Bt({leadId:e}){const[t,r]=N.useState([]),[s,a]=N.useState(!0),[i,o]=N.useState(!1),c=async()=>{a(!0);try{const d=await Ft(e);r(d||[])}catch(d){console.error("Error loading logs:",d)}finally{a(!1)}};N.useEffect(()=>{c()},[e]);const m=()=>{o(!1),c()};return s&&!t.length?n.jsx(Ge,{size:"sm"}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Communication History"}),!i&&n.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"+ Log Communication"})]}),i&&n.jsx(Pt,{leadId:e,onAdd:m,onCancel:()=>o(!1)}),n.jsx("div",{className:"flow-root",children:n.jsx("ul",{className:"-mb-8",children:t.length===0?n.jsx("li",{className:"text-center py-8 text-gray-500",children:"No communication logs yet."}):t.map((d,u)=>n.jsx("li",{children:n.jsxs("div",{className:"relative pb-8",children:[u!==t.length-1?n.jsx("span",{className:"absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200","aria-hidden":"true"}):null,n.jsxs("div",{className:"relative flex space-x-3",children:[n.jsx("div",{className:"relative",children:n.jsx("span",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center ring-8 ring-white text-lg",children:Ut[d.type]||"ðŸ“"})}),n.jsxs("div",{className:"min-w-0 flex-1 pt-1.5 flex justify-between space-x-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[n.jsx("span",{className:"font-medium text-gray-900",children:d.user_name})," logged a"," ",n.jsx("span",{className:"font-medium text-gray-900 capitalize",children:d.type}),d.direction==="inbound"&&n.jsx("span",{className:"ml-1 text-xs bg-blue-100 text-blue-800 px-1.5 py-0.5 rounded",children:"Inbound"})]}),d.subject&&n.jsx("p",{className:"text-sm font-medium text-gray-900 mt-1",children:d.subject}),n.jsx("p",{className:"text-sm text-gray-600 mt-1 whitespace-pre-wrap",children:d.content}),d.follow_up_date&&n.jsxs("div",{className:"mt-2 text-xs text-orange-600 flex items-center gap-1",children:[n.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Follow-up: ",$(d.follow_up_date),d.follow_up_note&&n.jsxs("span",{className:"text-gray-500",children:["- ",d.follow_up_note]})]})]}),n.jsxs("div",{className:"text-right text-sm whitespace-nowrap text-gray-500",children:[n.jsx("div",{children:$(d.created_at)}),d.outcome&&n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium mt-1 ${Dt[d.outcome]||"bg-gray-100 text-gray-800"}`,children:d.outcome.replace("_"," ")}),d.duration_seconds&&n.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[Math.round(d.duration_seconds/60)," mins"]})]})]})]})]})},d.id))})})]})}function Ze(e,t){return function(){return e.apply(t,arguments)}}const{toString:Mt}=Object.prototype,{getPrototypeOf:Ee}=Object,{iterator:ue,toStringTag:Ye}=Symbol,fe=(e=>t=>{const r=Mt.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),U=e=>(e=e.toLowerCase(),t=>fe(t)===e),me=e=>t=>typeof t===e,{isArray:X}=Array,K=me("undefined");function Y(e){return e!==null&&!K(e)&&e.constructor!==null&&!K(e.constructor)&&k(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const et=U("ArrayBuffer");function $t(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&et(e.buffer),t}const qt=me("string"),k=me("function"),tt=me("number"),ee=e=>e!==null&&typeof e=="object",It=e=>e===!0||e===!1,ie=e=>{if(fe(e)!=="object")return!1;const t=Ee(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Ye in e)&&!(ue in e)},Ht=e=>{if(!ee(e)||Y(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},zt=U("Date"),Wt=U("File"),Jt=U("Blob"),Vt=U("FileList"),Kt=e=>ee(e)&&k(e.pipe),Xt=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||k(e.append)&&((t=fe(e))==="formdata"||t==="object"&&k(e.toString)&&e.toString()==="[object FormData]"))},Qt=U("URLSearchParams"),[Gt,Zt,Yt,es]=["ReadableStream","Request","Response","Headers"].map(U),ts=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function te(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let s,a;if(typeof e!="object"&&(e=[e]),X(e))for(s=0,a=e.length;s<a;s++)t.call(null,e[s],s,e);else{if(Y(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let c;for(s=0;s<o;s++)c=i[s],t.call(null,e[c],c,e)}}function st(e,t){if(Y(e))return null;t=t.toLowerCase();const r=Object.keys(e);let s=r.length,a;for(;s-- >0;)if(a=r[s],t===a.toLowerCase())return a;return null}const q=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,rt=e=>!K(e)&&e!==q;function we(){const{caseless:e,skipUndefined:t}=rt(this)&&this||{},r={},s=(a,i)=>{const o=e&&st(r,i)||i;ie(r[o])&&ie(a)?r[o]=we(r[o],a):ie(a)?r[o]=we({},a):X(a)?r[o]=a.slice():(!t||!K(a))&&(r[o]=a)};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&te(arguments[a],s);return r}const ss=(e,t,r,{allOwnKeys:s}={})=>(te(t,(a,i)=>{r&&k(a)?e[i]=Ze(a,r):e[i]=a},{allOwnKeys:s}),e),rs=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),ns=(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},as=(e,t,r,s)=>{let a,i,o;const c={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!s||s(o,e,t))&&!c[o]&&(t[o]=e[o],c[o]=!0);e=r!==!1&&Ee(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},os=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const s=e.indexOf(t,r);return s!==-1&&s===r},is=e=>{if(!e)return null;if(X(e))return e;let t=e.length;if(!tt(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},ls=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ee(Uint8Array)),cs=(e,t)=>{const s=(e&&e[ue]).call(e);let a;for(;(a=s.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},ds=(e,t)=>{let r;const s=[];for(;(r=e.exec(t))!==null;)s.push(r);return s},us=U("HTMLFormElement"),fs=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,a){return s.toUpperCase()+a}),Fe=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),ms=U("RegExp"),nt=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),s={};te(r,(a,i)=>{let o;(o=t(a,i,e))!==!1&&(s[i]=o||a)}),Object.defineProperties(e,s)},hs=e=>{nt(e,(t,r)=>{if(k(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=e[r];if(k(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},ps=(e,t)=>{const r={},s=a=>{a.forEach(i=>{r[i]=!0})};return X(e)?s(e):s(String(e).split(t)),r},xs=()=>{},gs=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function bs(e){return!!(e&&k(e.append)&&e[Ye]==="FormData"&&e[ue])}const ys=e=>{const t=new Array(10),r=(s,a)=>{if(ee(s)){if(t.indexOf(s)>=0)return;if(Y(s))return s;if(!("toJSON"in s)){t[a]=s;const i=X(s)?[]:{};return te(s,(o,c)=>{const m=r(o,a+1);!K(m)&&(i[c]=m)}),t[a]=void 0,i}}return s};return r(e,0)},ws=U("AsyncFunction"),js=e=>e&&(ee(e)||k(e))&&k(e.then)&&k(e.catch),at=((e,t)=>e?setImmediate:t?((r,s)=>(q.addEventListener("message",({source:a,data:i})=>{a===q&&i===r&&s.length&&s.shift()()},!1),a=>{s.push(a),q.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",k(q.postMessage)),Ns=typeof queueMicrotask<"u"?queueMicrotask.bind(q):typeof process<"u"&&process.nextTick||at,Ss=e=>e!=null&&k(e[ue]),l={isArray:X,isArrayBuffer:et,isBuffer:Y,isFormData:Xt,isArrayBufferView:$t,isString:qt,isNumber:tt,isBoolean:It,isObject:ee,isPlainObject:ie,isEmptyObject:Ht,isReadableStream:Gt,isRequest:Zt,isResponse:Yt,isHeaders:es,isUndefined:K,isDate:zt,isFile:Wt,isBlob:Jt,isRegExp:ms,isFunction:k,isStream:Kt,isURLSearchParams:Qt,isTypedArray:ls,isFileList:Vt,forEach:te,merge:we,extend:ss,trim:ts,stripBOM:rs,inherits:ns,toFlatObject:as,kindOf:fe,kindOfTest:U,endsWith:os,toArray:is,forEachEntry:cs,matchAll:ds,isHTMLForm:us,hasOwnProperty:Fe,hasOwnProp:Fe,reduceDescriptors:nt,freezeMethods:hs,toObjectSet:ps,toCamelCase:fs,noop:xs,toFiniteNumber:gs,findKey:st,global:q,isContextDefined:rt,isSpecCompliantForm:bs,toJSONObject:ys,isAsyncFn:ws,isThenable:js,setImmediate:at,asap:Ns,isIterable:Ss};function y(e,t,r,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}l.inherits(y,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:l.toJSONObject(this.config),code:this.code,status:this.status}}});const ot=y.prototype,it={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{it[e]={value:e}});Object.defineProperties(y,it);Object.defineProperty(ot,"isAxiosError",{value:!0});y.from=(e,t,r,s,a,i)=>{const o=Object.create(ot);l.toFlatObject(e,o,function(u){return u!==Error.prototype},d=>d!=="isAxiosError");const c=e&&e.message?e.message:"Error",m=t==null&&e?e.code:t;return y.call(o,c,m,r,s,a),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const Es=null;function je(e){return l.isPlainObject(e)||l.isArray(e)}function lt(e){return l.endsWith(e,"[]")?e.slice(0,-2):e}function Pe(e,t,r){return e?e.concat(t).map(function(a,i){return a=lt(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function vs(e){return l.isArray(e)&&!e.some(je)}const Rs=l.toFlatObject(l,{},null,function(t){return/^is[A-Z]/.test(t)});function he(e,t,r){if(!l.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=l.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,h){return!l.isUndefined(h[g])});const s=r.metaTokens,a=r.visitor||u,i=r.dots,o=r.indexes,m=(r.Blob||typeof Blob<"u"&&Blob)&&l.isSpecCompliantForm(t);if(!l.isFunction(a))throw new TypeError("visitor must be a function");function d(f){if(f===null)return"";if(l.isDate(f))return f.toISOString();if(l.isBoolean(f))return f.toString();if(!m&&l.isBlob(f))throw new y("Blob is not supported. Use a Buffer instead.");return l.isArrayBuffer(f)||l.isTypedArray(f)?m&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function u(f,g,h){let b=f;if(f&&!h&&typeof f=="object"){if(l.endsWith(g,"{}"))g=s?g:g.slice(0,-2),f=JSON.stringify(f);else if(l.isArray(f)&&vs(f)||(l.isFileList(f)||l.endsWith(g,"[]"))&&(b=l.toArray(f)))return g=lt(g),b.forEach(function(v,R){!(l.isUndefined(v)||v===null)&&t.append(o===!0?Pe([g],R,i):o===null?g:g+"[]",d(v))}),!1}return je(f)?!0:(t.append(Pe(h,g,i),d(f)),!1)}const p=[],j=Object.assign(Rs,{defaultVisitor:u,convertValue:d,isVisitable:je});function S(f,g){if(!l.isUndefined(f)){if(p.indexOf(f)!==-1)throw Error("Circular reference detected in "+g.join("."));p.push(f),l.forEach(f,function(b,O){(!(l.isUndefined(b)||b===null)&&a.call(t,b,l.isString(O)?O.trim():O,g,j))===!0&&S(b,g?g.concat(O):[O])}),p.pop()}}if(!l.isObject(e))throw new TypeError("data must be an object");return S(e),t}function Ue(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function ve(e,t){this._pairs=[],e&&he(e,this,t)}const ct=ve.prototype;ct.append=function(t,r){this._pairs.push([t,r])};ct.toString=function(t){const r=t?function(s){return t.call(this,s,Ue)}:Ue;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function As(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function dt(e,t,r){if(!t)return e;const s=r&&r.encode||As;l.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=l.isURLSearchParams(t)?t.toString():new ve(t,r).toString(s),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class De{constructor(){this.handlers=[]}use(t,r,s){return this.handlers.push({fulfilled:t,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){l.forEach(this.handlers,function(s){s!==null&&t(s)})}}const ut={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Cs=typeof URLSearchParams<"u"?URLSearchParams:ve,Os=typeof FormData<"u"?FormData:null,_s=typeof Blob<"u"?Blob:null,Ts={isBrowser:!0,classes:{URLSearchParams:Cs,FormData:Os,Blob:_s},protocols:["http","https","file","blob","url","data"]},Re=typeof window<"u"&&typeof document<"u",Ne=typeof navigator=="object"&&navigator||void 0,Ls=Re&&(!Ne||["ReactNative","NativeScript","NS"].indexOf(Ne.product)<0),ks=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Fs=Re&&window.location.href||"http://localhost",Ps=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Re,hasStandardBrowserEnv:Ls,hasStandardBrowserWebWorkerEnv:ks,navigator:Ne,origin:Fs},Symbol.toStringTag,{value:"Module"})),L={...Ps,...Ts};function Us(e,t){return he(e,new L.classes.URLSearchParams,{visitor:function(r,s,a,i){return L.isNode&&l.isBuffer(r)?(this.append(s,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Ds(e){return l.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Bs(e){const t={},r=Object.keys(e);let s;const a=r.length;let i;for(s=0;s<a;s++)i=r[s],t[i]=e[i];return t}function ft(e){function t(r,s,a,i){let o=r[i++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),m=i>=r.length;return o=!o&&l.isArray(a)?a.length:o,m?(l.hasOwnProp(a,o)?a[o]=[a[o],s]:a[o]=s,!c):((!a[o]||!l.isObject(a[o]))&&(a[o]=[]),t(r,s,a[o],i)&&l.isArray(a[o])&&(a[o]=Bs(a[o])),!c)}if(l.isFormData(e)&&l.isFunction(e.entries)){const r={};return l.forEachEntry(e,(s,a)=>{t(Ds(s),a,r,0)}),r}return null}function Ms(e,t,r){if(l.isString(e))try{return(t||JSON.parse)(e),l.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(e)}const se={transitional:ut,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const s=r.getContentType()||"",a=s.indexOf("application/json")>-1,i=l.isObject(t);if(i&&l.isHTMLForm(t)&&(t=new FormData(t)),l.isFormData(t))return a?JSON.stringify(ft(t)):t;if(l.isArrayBuffer(t)||l.isBuffer(t)||l.isStream(t)||l.isFile(t)||l.isBlob(t)||l.isReadableStream(t))return t;if(l.isArrayBufferView(t))return t.buffer;if(l.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Us(t,this.formSerializer).toString();if((c=l.isFileList(t))||s.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return he(c?{"files[]":t}:t,m&&new m,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),Ms(t)):t}],transformResponse:[function(t){const r=this.transitional||se.transitional,s=r&&r.forcedJSONParsing,a=this.responseType==="json";if(l.isResponse(t)||l.isReadableStream(t))return t;if(t&&l.isString(t)&&(s&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(c){if(o)throw c.name==="SyntaxError"?y.from(c,y.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:L.classes.FormData,Blob:L.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};l.forEach(["delete","get","head","post","put","patch"],e=>{se.headers[e]={}});const $s=l.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),qs=e=>{const t={};let r,s,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),s=o.substring(a+1).trim(),!(!r||t[r]&&$s[r])&&(r==="set-cookie"?t[r]?t[r].push(s):t[r]=[s]:t[r]=t[r]?t[r]+", "+s:s)}),t},Be=Symbol("internals");function G(e){return e&&String(e).trim().toLowerCase()}function le(e){return e===!1||e==null?e:l.isArray(e)?e.map(le):String(e)}function Is(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(e);)t[s[1]]=s[2];return t}const Hs=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ge(e,t,r,s,a){if(l.isFunction(s))return s.call(this,t,r);if(a&&(t=r),!!l.isString(t)){if(l.isString(s))return t.indexOf(s)!==-1;if(l.isRegExp(s))return s.test(t)}}function zs(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,s)=>r.toUpperCase()+s)}function Ws(e,t){const r=l.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+r,{value:function(a,i,o){return this[s].call(this,t,a,i,o)},configurable:!0})})}let F=class{constructor(t){t&&this.set(t)}set(t,r,s){const a=this;function i(c,m,d){const u=G(m);if(!u)throw new Error("header name must be a non-empty string");const p=l.findKey(a,u);(!p||a[p]===void 0||d===!0||d===void 0&&a[p]!==!1)&&(a[p||m]=le(c))}const o=(c,m)=>l.forEach(c,(d,u)=>i(d,u,m));if(l.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(l.isString(t)&&(t=t.trim())&&!Hs(t))o(qs(t),r);else if(l.isObject(t)&&l.isIterable(t)){let c={},m,d;for(const u of t){if(!l.isArray(u))throw TypeError("Object iterator must return a key-value pair");c[d=u[0]]=(m=c[d])?l.isArray(m)?[...m,u[1]]:[m,u[1]]:u[1]}o(c,r)}else t!=null&&i(r,t,s);return this}get(t,r){if(t=G(t),t){const s=l.findKey(this,t);if(s){const a=this[s];if(!r)return a;if(r===!0)return Is(a);if(l.isFunction(r))return r.call(this,a,s);if(l.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=G(t),t){const s=l.findKey(this,t);return!!(s&&this[s]!==void 0&&(!r||ge(this,this[s],s,r)))}return!1}delete(t,r){const s=this;let a=!1;function i(o){if(o=G(o),o){const c=l.findKey(s,o);c&&(!r||ge(s,s[c],c,r))&&(delete s[c],a=!0)}}return l.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let s=r.length,a=!1;for(;s--;){const i=r[s];(!t||ge(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,s={};return l.forEach(this,(a,i)=>{const o=l.findKey(s,i);if(o){r[o]=le(a),delete r[i];return}const c=t?zs(i):String(i).trim();c!==i&&delete r[i],r[c]=le(a),s[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return l.forEach(this,(s,a)=>{s!=null&&s!==!1&&(r[a]=t&&l.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const s=new this(t);return r.forEach(a=>s.set(a)),s}static accessor(t){const s=(this[Be]=this[Be]={accessors:{}}).accessors,a=this.prototype;function i(o){const c=G(o);s[c]||(Ws(a,o),s[c]=!0)}return l.isArray(t)?t.forEach(i):i(t),this}};F.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);l.reduceDescriptors(F.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[r]=s}}});l.freezeMethods(F);function be(e,t){const r=this||se,s=t||r,a=F.from(s.headers);let i=s.data;return l.forEach(e,function(c){i=c.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function mt(e){return!!(e&&e.__CANCEL__)}function Q(e,t,r){y.call(this,e??"canceled",y.ERR_CANCELED,t,r),this.name="CanceledError"}l.inherits(Q,y,{__CANCEL__:!0});function ht(e,t,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):t(new y("Request failed with status code "+r.status,[y.ERR_BAD_REQUEST,y.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Js(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Vs(e,t){e=e||10;const r=new Array(e),s=new Array(e);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(m){const d=Date.now(),u=s[i];o||(o=d),r[a]=m,s[a]=d;let p=i,j=0;for(;p!==a;)j+=r[p++],p=p%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),d-o<t)return;const S=u&&d-u;return S?Math.round(j*1e3/S):void 0}}function Ks(e,t){let r=0,s=1e3/t,a,i;const o=(d,u=Date.now())=>{r=u,a=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const u=Date.now(),p=u-r;p>=s?o(d,u):(a=d,i||(i=setTimeout(()=>{i=null,o(a)},s-p)))},()=>a&&o(a)]}const de=(e,t,r=3)=>{let s=0;const a=Vs(50,250);return Ks(i=>{const o=i.loaded,c=i.lengthComputable?i.total:void 0,m=o-s,d=a(m),u=o<=c;s=o;const p={loaded:o,total:c,progress:c?o/c:void 0,bytes:m,rate:d||void 0,estimated:d&&c&&u?(c-o)/d:void 0,event:i,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(p)},r)},Me=(e,t)=>{const r=e!=null;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},$e=e=>(...t)=>l.asap(()=>e(...t)),Xs=L.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,L.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(L.origin),L.navigator&&/(msie|trident)/i.test(L.navigator.userAgent)):()=>!0,Qs=L.hasStandardBrowserEnv?{write(e,t,r,s,a,i,o){if(typeof document>"u")return;const c=[`${e}=${encodeURIComponent(t)}`];l.isNumber(r)&&c.push(`expires=${new Date(r).toUTCString()}`),l.isString(s)&&c.push(`path=${s}`),l.isString(a)&&c.push(`domain=${a}`),i===!0&&c.push("secure"),l.isString(o)&&c.push(`SameSite=${o}`),document.cookie=c.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Gs(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Zs(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function pt(e,t,r){let s=!Gs(t);return e&&(s||r==!1)?Zs(e,t):t}const qe=e=>e instanceof F?{...e}:e;function H(e,t){t=t||{};const r={};function s(d,u,p,j){return l.isPlainObject(d)&&l.isPlainObject(u)?l.merge.call({caseless:j},d,u):l.isPlainObject(u)?l.merge({},u):l.isArray(u)?u.slice():u}function a(d,u,p,j){if(l.isUndefined(u)){if(!l.isUndefined(d))return s(void 0,d,p,j)}else return s(d,u,p,j)}function i(d,u){if(!l.isUndefined(u))return s(void 0,u)}function o(d,u){if(l.isUndefined(u)){if(!l.isUndefined(d))return s(void 0,d)}else return s(void 0,u)}function c(d,u,p){if(p in t)return s(d,u);if(p in e)return s(void 0,d)}const m={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(d,u,p)=>a(qe(d),qe(u),p,!0)};return l.forEach(Object.keys({...e,...t}),function(u){const p=m[u]||a,j=p(e[u],t[u],u);l.isUndefined(j)&&p!==c||(r[u]=j)}),r}const xt=e=>{const t=H({},e);let{data:r,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:c}=t;if(t.headers=o=F.from(o),t.url=dt(pt(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),l.isFormData(r)){if(L.hasStandardBrowserEnv||L.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(l.isFunction(r.getHeaders)){const m=r.getHeaders(),d=["content-type","content-length"];Object.entries(m).forEach(([u,p])=>{d.includes(u.toLowerCase())&&o.set(u,p)})}}if(L.hasStandardBrowserEnv&&(s&&l.isFunction(s)&&(s=s(t)),s||s!==!1&&Xs(t.url))){const m=a&&i&&Qs.read(i);m&&o.set(a,m)}return t},Ys=typeof XMLHttpRequest<"u",er=Ys&&function(e){return new Promise(function(r,s){const a=xt(e);let i=a.data;const o=F.from(a.headers).normalize();let{responseType:c,onUploadProgress:m,onDownloadProgress:d}=a,u,p,j,S,f;function g(){S&&S(),f&&f(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let h=new XMLHttpRequest;h.open(a.method.toUpperCase(),a.url,!0),h.timeout=a.timeout;function b(){if(!h)return;const v=F.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),T={data:!c||c==="text"||c==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:v,config:e,request:h};ht(function(C){r(C),g()},function(C){s(C),g()},T),h=null}"onloadend"in h?h.onloadend=b:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(b)},h.onabort=function(){h&&(s(new y("Request aborted",y.ECONNABORTED,e,h)),h=null)},h.onerror=function(R){const T=R&&R.message?R.message:"Network Error",E=new y(T,y.ERR_NETWORK,e,h);E.event=R||null,s(E),h=null},h.ontimeout=function(){let R=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const T=a.transitional||ut;a.timeoutErrorMessage&&(R=a.timeoutErrorMessage),s(new y(R,T.clarifyTimeoutError?y.ETIMEDOUT:y.ECONNABORTED,e,h)),h=null},i===void 0&&o.setContentType(null),"setRequestHeader"in h&&l.forEach(o.toJSON(),function(R,T){h.setRequestHeader(T,R)}),l.isUndefined(a.withCredentials)||(h.withCredentials=!!a.withCredentials),c&&c!=="json"&&(h.responseType=a.responseType),d&&([j,f]=de(d,!0),h.addEventListener("progress",j)),m&&h.upload&&([p,S]=de(m),h.upload.addEventListener("progress",p),h.upload.addEventListener("loadend",S)),(a.cancelToken||a.signal)&&(u=v=>{h&&(s(!v||v.type?new Q(null,e,h):v),h.abort(),h=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const O=Js(a.url);if(O&&L.protocols.indexOf(O)===-1){s(new y("Unsupported protocol "+O+":",y.ERR_BAD_REQUEST,e));return}h.send(i||null)})},tr=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let s=new AbortController,a;const i=function(d){if(!a){a=!0,c();const u=d instanceof Error?d:this.reason;s.abort(u instanceof y?u:new Q(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,i(new y(`timeout ${t} of ms exceeded`,y.ETIMEDOUT))},t);const c=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:m}=s;return m.unsubscribe=()=>l.asap(c),m}},sr=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let s=0,a;for(;s<r;)a=s+t,yield e.slice(s,a),s=a},rr=async function*(e,t){for await(const r of nr(e))yield*sr(r,t)},nr=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:s}=await t.read();if(r)break;yield s}}finally{await t.cancel()}},Ie=(e,t,r,s)=>{const a=rr(e,t);let i=0,o,c=m=>{o||(o=!0,s&&s(m))};return new ReadableStream({async pull(m){try{const{done:d,value:u}=await a.next();if(d){c(),m.close();return}let p=u.byteLength;if(r){let j=i+=p;r(j)}m.enqueue(new Uint8Array(u))}catch(d){throw c(d),d}},cancel(m){return c(m),a.return()}},{highWaterMark:2})},He=64*1024,{isFunction:oe}=l,ar=(({Request:e,Response:t})=>({Request:e,Response:t}))(l.global),{ReadableStream:ze,TextEncoder:We}=l.global,Je=(e,...t)=>{try{return!!e(...t)}catch{return!1}},or=e=>{e=l.merge.call({skipUndefined:!0},ar,e);const{fetch:t,Request:r,Response:s}=e,a=t?oe(t):typeof fetch=="function",i=oe(r),o=oe(s);if(!a)return!1;const c=a&&oe(ze),m=a&&(typeof We=="function"?(f=>g=>f.encode(g))(new We):async f=>new Uint8Array(await new r(f).arrayBuffer())),d=i&&c&&Je(()=>{let f=!1;const g=new r(L.origin,{body:new ze,method:"POST",get duplex(){return f=!0,"half"}}).headers.has("Content-Type");return f&&!g}),u=o&&c&&Je(()=>l.isReadableStream(new s("").body)),p={stream:u&&(f=>f.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(f=>{!p[f]&&(p[f]=(g,h)=>{let b=g&&g[f];if(b)return b.call(g);throw new y(`Response type '${f}' is not supported`,y.ERR_NOT_SUPPORT,h)})});const j=async f=>{if(f==null)return 0;if(l.isBlob(f))return f.size;if(l.isSpecCompliantForm(f))return(await new r(L.origin,{method:"POST",body:f}).arrayBuffer()).byteLength;if(l.isArrayBufferView(f)||l.isArrayBuffer(f))return f.byteLength;if(l.isURLSearchParams(f)&&(f=f+""),l.isString(f))return(await m(f)).byteLength},S=async(f,g)=>{const h=l.toFiniteNumber(f.getContentLength());return h??j(g)};return async f=>{let{url:g,method:h,data:b,signal:O,cancelToken:v,timeout:R,onDownloadProgress:T,onUploadProgress:E,responseType:C,headers:z,withCredentials:W="same-origin",fetchOptions:re}=xt(f),ne=t||fetch;C=C?(C+"").toLowerCase():"text";let J=tr([O,v&&v.toAbortSignal()],R),x=null;const w=J&&J.unsubscribe&&(()=>{J.unsubscribe()});let _;try{if(E&&d&&h!=="get"&&h!=="head"&&(_=await S(z,b))!==0){let M=new r(g,{method:"POST",body:b,duplex:"half"}),V;if(l.isFormData(b)&&(V=M.headers.get("content-type"))&&z.setContentType(V),M.body){const[xe,ae]=Me(_,de($e(E)));b=Ie(M.body,He,xe,ae)}}l.isString(W)||(W=W?"include":"omit");const P=i&&"credentials"in r.prototype,Ce={...re,signal:J,method:h.toUpperCase(),headers:z.normalize().toJSON(),body:b,duplex:"half",credentials:P?W:void 0};x=i&&new r(g,Ce);let B=await(i?ne(x,re):ne(g,Ce));const Oe=u&&(C==="stream"||C==="response");if(u&&(T||Oe&&w)){const M={};["status","statusText","headers"].forEach(_e=>{M[_e]=B[_e]});const V=l.toFiniteNumber(B.headers.get("content-length")),[xe,ae]=T&&Me(V,de($e(T),!0))||[];B=new s(Ie(B.body,He,xe,()=>{ae&&ae(),w&&w()}),M)}C=C||"text";let Nt=await p[l.findKey(p,C)||"text"](B,f);return!Oe&&w&&w(),await new Promise((M,V)=>{ht(M,V,{data:Nt,headers:F.from(B.headers),status:B.status,statusText:B.statusText,config:f,request:x})})}catch(P){throw w&&w(),P&&P.name==="TypeError"&&/Load failed|fetch/i.test(P.message)?Object.assign(new y("Network Error",y.ERR_NETWORK,f,x),{cause:P.cause||P}):y.from(P,P&&P.code,f,x)}}},ir=new Map,gt=e=>{let t=e&&e.env||{};const{fetch:r,Request:s,Response:a}=t,i=[s,a,r];let o=i.length,c=o,m,d,u=ir;for(;c--;)m=i[c],d=u.get(m),d===void 0&&u.set(m,d=c?new Map:or(t)),u=d;return d};gt();const Ae={http:Es,xhr:er,fetch:{get:gt}};l.forEach(Ae,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Ve=e=>`- ${e}`,lr=e=>l.isFunction(e)||e===null||e===!1;function cr(e,t){e=l.isArray(e)?e:[e];const{length:r}=e;let s,a;const i={};for(let o=0;o<r;o++){s=e[o];let c;if(a=s,!lr(s)&&(a=Ae[(c=String(s)).toLowerCase()],a===void 0))throw new y(`Unknown adapter '${c}'`);if(a&&(l.isFunction(a)||(a=a.get(t))))break;i[c||"#"+o]=a}if(!a){const o=Object.entries(i).map(([m,d])=>`adapter ${m} `+(d===!1?"is not supported by the environment":"is not available in the build"));let c=r?o.length>1?`since :
`+o.map(Ve).join(`
`):" "+Ve(o[0]):"as no adapter specified";throw new y("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return a}const bt={getAdapter:cr,adapters:Ae};function ye(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Q(null,e)}function Ke(e){return ye(e),e.headers=F.from(e.headers),e.data=be.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),bt.getAdapter(e.adapter||se.adapter,e)(e).then(function(s){return ye(e),s.data=be.call(e,e.transformResponse,s),s.headers=F.from(s.headers),s},function(s){return mt(s)||(ye(e),s&&s.response&&(s.response.data=be.call(e,e.transformResponse,s.response),s.response.headers=F.from(s.response.headers))),Promise.reject(s)})}const yt="1.13.2",pe={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{pe[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const Xe={};pe.transitional=function(t,r,s){function a(i,o){return"[Axios v"+yt+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,c)=>{if(t===!1)throw new y(a(o," has been removed"+(r?" in "+r:"")),y.ERR_DEPRECATED);return r&&!Xe[o]&&(Xe[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,c):!0}};pe.spelling=function(t){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function dr(e,t,r){if(typeof e!="object")throw new y("options must be an object",y.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let a=s.length;for(;a-- >0;){const i=s[a],o=t[i];if(o){const c=e[i],m=c===void 0||o(c,i,e);if(m!==!0)throw new y("option "+i+" must be "+m,y.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new y("Unknown option "+i,y.ERR_BAD_OPTION)}}const ce={assertOptions:dr,validators:pe},D=ce.validators;let I=class{constructor(t){this.defaults=t||{},this.interceptors={request:new De,response:new De}}async request(t,r){try{return await this._request(t,r)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=H(this.defaults,r);const{transitional:s,paramsSerializer:a,headers:i}=r;s!==void 0&&ce.assertOptions(s,{silentJSONParsing:D.transitional(D.boolean),forcedJSONParsing:D.transitional(D.boolean),clarifyTimeoutError:D.transitional(D.boolean)},!1),a!=null&&(l.isFunction(a)?r.paramsSerializer={serialize:a}:ce.assertOptions(a,{encode:D.function,serialize:D.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ce.assertOptions(r,{baseUrl:D.spelling("baseURL"),withXsrfToken:D.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&l.merge(i.common,i[r.method]);i&&l.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),r.headers=F.concat(o,i);const c=[];let m=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(m=m&&g.synchronous,c.unshift(g.fulfilled,g.rejected))});const d=[];this.interceptors.response.forEach(function(g){d.push(g.fulfilled,g.rejected)});let u,p=0,j;if(!m){const f=[Ke.bind(this),void 0];for(f.unshift(...c),f.push(...d),j=f.length,u=Promise.resolve(r);p<j;)u=u.then(f[p++],f[p++]);return u}j=c.length;let S=r;for(;p<j;){const f=c[p++],g=c[p++];try{S=f(S)}catch(h){g.call(this,h);break}}try{u=Ke.call(this,S)}catch(f){return Promise.reject(f)}for(p=0,j=d.length;p<j;)u=u.then(d[p++],d[p++]);return u}getUri(t){t=H(this.defaults,t);const r=pt(t.baseURL,t.url,t.allowAbsoluteUrls);return dt(r,t.params,t.paramsSerializer)}};l.forEach(["delete","get","head","options"],function(t){I.prototype[t]=function(r,s){return this.request(H(s||{},{method:t,url:r,data:(s||{}).data}))}});l.forEach(["post","put","patch"],function(t){function r(s){return function(i,o,c){return this.request(H(c||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}I.prototype[t]=r(),I.prototype[t+"Form"]=r(!0)});let ur=class wt{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const s=this;this.promise.then(a=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](a);s._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(c=>{s.subscribe(c),i=c}).then(a);return o.cancel=function(){s.unsubscribe(i)},o},t(function(i,o,c){s.reason||(s.reason=new Q(i,o,c),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=s=>{t.abort(s)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new wt(function(a){t=a}),cancel:t}}};function fr(e){return function(r){return e.apply(null,r)}}function mr(e){return l.isObject(e)&&e.isAxiosError===!0}const Se={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Se).forEach(([e,t])=>{Se[t]=e});function jt(e){const t=new I(e),r=Ze(I.prototype.request,t);return l.extend(r,I.prototype,t,{allOwnKeys:!0}),l.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return jt(H(e,a))},r}const A=jt(se);A.Axios=I;A.CanceledError=Q;A.CancelToken=ur;A.isCancel=mt;A.VERSION=yt;A.toFormData=he;A.AxiosError=y;A.Cancel=A.CanceledError;A.all=function(t){return Promise.all(t)};A.spread=fr;A.isAxiosError=mr;A.mergeConfig=H;A.AxiosHeaders=F;A.formToJSON=e=>ft(l.isHTMLForm(e)?new FormData(e):e);A.getAdapter=bt.getAdapter;A.HttpStatusCode=Se;A.default=A;const{Axios:Rr,AxiosError:Ar,CanceledError:Cr,isCancel:Or,CancelToken:_r,VERSION:Tr,all:Lr,Cancel:kr,isAxiosError:Fr,spread:Pr,toFormData:Ur,AxiosHeaders:Dr,HttpStatusCode:Br,formToJSON:Mr,getAdapter:$r,mergeConfig:qr}=A,hr="https://operation.aqleeat.co/wp-json",pr=()=>localStorage.getItem("token"),Z=A.create({baseURL:hr,headers:{"Content-Type":"application/json"}});Z.interceptors.request.use(e=>{const t=pr();return t&&(e.headers.Authorization=`Bearer ${t}`),e});const Qe={sendMessage:async e=>{try{return(await Z.post("/whatsapp/send",e)).data}catch(t){throw console.error("Error sending WhatsApp message:",t),t}},getMessages:async e=>{try{return(await Z.get(`/leads/${e}/whatsapp/messages`)).data}catch(t){throw console.error("Error fetching WhatsApp messages:",t),t}},getTemplates:async()=>{try{return(await Z.get("/whatsapp/templates")).data}catch(e){throw console.error("Error fetching WhatsApp templates:",e),e}},testConnection:async()=>{try{return(await Z.post("/whatsapp/test")).data}catch(e){throw console.error("Error testing WhatsApp connection:",e),e}}};function xr({leadId:e,leadPhone:t}){const[r,s]=N.useState([]),[a,i]=N.useState(""),[o,c]=N.useState(!0),[m,d]=N.useState(!1),[u,p]=N.useState(null),j=N.useRef(null);N.useEffect(()=>{f();const b=setInterval(f,1e4);return()=>clearInterval(b)},[e]),N.useEffect(()=>{S()},[r]);const S=()=>{j.current?.scrollIntoView({behavior:"smooth"})},f=async()=>{try{const b=await Qe.getMessages(e);s(b),p(null)}catch(b){console.error("Failed to fetch messages",b),o&&p("Failed to load chat history.")}finally{c(!1)}},g=async b=>{if(b.preventDefault(),!!a.trim()){d(!0);try{await Qe.sendMessage({lead_id:e,message:a,type:"text"}),i(""),f()}catch{p("Failed to send message. Please try again.")}finally{d(!1)}}},h=b=>new Date(b).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return o?n.jsx("div",{className:"flex justify-center items-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"})}):n.jsxs("div",{className:"flex flex-col h-[600px] bg-[#e5ddd5] rounded-lg shadow-lg overflow-hidden border border-gray-200",children:[n.jsxs("div",{className:"bg-[#075e54] text-white p-4 flex items-center justify-between shadow-md",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-gray-600 font-bold",children:n.jsx("span",{className:"dashicons dashicons-whatsapp text-2xl"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-lg",children:"WhatsApp Chat"}),n.jsx("p",{className:"text-xs opacity-80",children:t})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),n.jsx("span",{className:"text-xs",children:"Live"})]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-[url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png')] bg-repeat",children:[r.length===0?n.jsx("div",{className:"text-center text-gray-500 my-10 bg-white/80 p-4 rounded-lg inline-block mx-auto shadow-sm",children:n.jsx("p",{children:"No messages yet. Start the conversation!"})}):r.map(b=>n.jsx("div",{className:`flex ${b.direction==="outbound"?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`max-w-[70%] rounded-lg p-3 shadow-sm relative ${b.direction==="outbound"?"bg-[#dcf8c6] rounded-tr-none":"bg-white rounded-tl-none"}`,children:[n.jsx("p",{className:"text-gray-800 text-sm whitespace-pre-wrap",children:b.content}),n.jsxs("div",{className:"flex items-center justify-end gap-1 mt-1",children:[n.jsx("span",{className:"text-[10px] text-gray-500",children:h(b.created_at)}),b.direction==="outbound"&&n.jsx("span",{className:`text-[10px] ${b.status==="read"?"text-blue-500":"text-gray-400"}`,children:b.status==="read"||b.status==="delivered"?"âœ“âœ“":"âœ“"})]})]})},b.id)),n.jsx("div",{ref:j})]}),u&&n.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-2 text-sm mx-4 mt-2",children:n.jsx("p",{children:u})}),n.jsxs("form",{onSubmit:g,className:"bg-[#f0f0f0] p-3 flex items-center gap-2 border-t border-gray-300",children:[n.jsx("button",{type:"button",className:"p-2 text-gray-500 hover:text-gray-700 transition-colors",title:"Attach (Coming Soon)",children:n.jsx("span",{className:"text-xl",children:"ðŸ“Ž"})}),n.jsx("input",{type:"text",value:a,onChange:b=>i(b.target.value),placeholder:"Type a message...",className:"flex-1 py-2 px-4 rounded-full border border-gray-300 focus:outline-none focus:border-[#075e54] focus:ring-1 focus:ring-[#075e54]",disabled:m}),n.jsx("button",{type:"submit",disabled:m||!a.trim(),className:`p-3 rounded-full text-white shadow-md transition-all ${m||!a.trim()?"bg-gray-400 cursor-not-allowed":"bg-[#075e54] hover:bg-[#128c7e]"}`,children:m?n.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsx("span",{className:"text-xl",children:"âž¤"})})]})]})}function Ir(){const{id:e}=St(),t=Et(),{user:r}=Tt(),[s,a]=N.useState(null),[i,o]=N.useState([]),[c,m]=N.useState([]),[d,u]=N.useState(!0),[p,j]=N.useState(null),[S,f]=N.useState("details"),[g,h]=N.useState(""),[b,O]=N.useState(!1),[v,R]=N.useState(""),[T,E]=N.useState(!1),[C,z]=N.useState(!1);N.useEffect(()=>{W()},[e]);const W=async()=>{u(!0),j(null);try{const x=await Te(e);if(x.success&&x.data){a(x.data),R(x.data.status_code);try{const w=await Le(e);w.success&&w.data&&o(w.data||[])}catch(w){console.error("Error fetching notes:",w)}try{const w=await ke(e);w.success&&w.data&&m(w.data||[])}catch(w){console.error("Error fetching events:",w)}}else j("Lead not found")}catch(x){console.error("Error fetching lead:",x),j(x.message||"Failed to load lead")}finally{u(!1)}},re=async x=>{if(x.preventDefault(),!!g.trim()){O(!0);try{await Ct(e,g),h("");const w=await Le(e);w.success&&w.data&&o(w.data||[])}catch(w){console.error("Error adding note:",w),alert("Failed to add note. Please try again.")}finally{O(!1)}}},ne=async()=>{if(!(!v||v===s.status_code)){E(!0);try{await Ot(e,v);const x=await Te(e);x.success&&x.data&&a(x.data),alert("Status updated successfully!")}catch(x){console.error("Error updating status:",x),alert("Failed to update status. Please try again."),R(s.status_code)}finally{E(!1)}}},J=async x=>{const w=x.target.files[0];if(w){z(!0);try{await _t(e,w),alert("Screenshot uploaded successfully!");const _=await ke(e);_.success&&_.data&&m(_.data||[])}catch(_){console.error("Error uploading file:",_),alert("Failed to upload file. Please try again.")}finally{z(!1),x.target.value=null}}};return d?n.jsx("div",{className:"flex justify-center items-center min-h-screen",children:n.jsx(Ge,{size:"lg",text:"Loading lead details..."})}):p||!s?n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[n.jsx("p",{className:"text-red-800",children:p||"Lead not found"}),n.jsx("button",{onClick:()=>t("/leads"),className:"mt-4 text-sm text-red-600 hover:text-red-800 underline",children:"â† Back to Leads"})]})}):n.jsxs("div",{className:"flex h-screen bg-gray-50",children:[n.jsx(Lt,{currentPage:"lead-detail"}),n.jsx("main",{className:"flex-1 overflow-y-auto",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsx("nav",{className:"mb-6",children:n.jsx(vt,{to:"/leads",className:"text-blue-600 hover:text-blue-800 text-sm",children:"â† Back to My Leads"})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:s.name}),n.jsxs("p",{className:"text-gray-600",children:["Lead ID: #",s.id]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${Rt(s.status_code)}`,children:s.status_name_en}),n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${At(s.priority)}`,children:s.priority})]})]}),n.jsxs("div",{className:"flex space-x-8 mt-8 border-b border-gray-200",children:[n.jsx("button",{onClick:()=>f("details"),className:`pb-4 text-sm font-medium ${S==="details"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Details & Activity"}),n.jsx("button",{onClick:()=>f("communications"),className:`pb-4 text-sm font-medium ${S==="communications"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Communications Log"}),n.jsx("button",{onClick:()=>f("whatsapp"),className:`pb-4 text-sm font-medium ${S==="whatsapp"?"text-green-600 border-b-2 border-green-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"dashicons dashicons-whatsapp"}),"WhatsApp"]})})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-2 space-y-6",children:S==="communications"?n.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:n.jsx(Bt,{leadId:e})}):S==="whatsapp"?n.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:n.jsx(xr,{leadId:e,leadPhone:s.whatsapp||s.phone})}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Contact Information"}),n.jsxs("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.email&&n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Email"}),n.jsx("dd",{className:"mt-1",children:n.jsx("a",{href:`mailto:${s.email}`,className:"text-blue-600 hover:text-blue-800",children:s.email})})]}),s.phone&&n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Phone"}),n.jsx("dd",{className:"mt-1",children:n.jsx("a",{href:`tel:${s.phone}`,className:"text-blue-600 hover:text-blue-800",children:s.phone})})]}),s.whatsapp&&n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"WhatsApp"}),n.jsx("dd",{className:"mt-1",children:n.jsxs("a",{href:`https://wa.me/${s.whatsapp}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[s.whatsapp,n.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]}),s.country_name_en&&n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Country"}),n.jsx("dd",{className:"mt-1 text-gray-900",children:s.country_name_en})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Lead Details"}),n.jsxs("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Source"}),n.jsx("dd",{className:"mt-1 text-gray-900",children:s.source_name||"N/A"})]}),n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Campaign"}),n.jsx("dd",{className:"mt-1 text-gray-900",children:s.campaign_name||"N/A"})]}),n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Assigned To"}),n.jsx("dd",{className:"mt-1 text-gray-900",children:s.assigned_to_name||"Unassigned"})]}),n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Created"}),n.jsx("dd",{className:"mt-1 text-gray-900",children:$(s.created_at)})]}),s.last_contact_at&&n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Last Contact"}),n.jsx("dd",{className:"mt-1 text-gray-900",children:$(s.last_contact_at)})]}),s.updated_at&&n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Last Updated"}),n.jsx("dd",{className:"mt-1 text-gray-900",children:$(s.updated_at)})]})]}),s.notes&&n.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 mb-2",children:"Initial Notes"}),n.jsx("dd",{className:"text-gray-900 whitespace-pre-wrap",children:s.notes})]})]}),s.custom_fields&&(()=>{try{const x=typeof s.custom_fields=="string"?JSON.parse(s.custom_fields):s.custom_fields;return!x||Object.keys(x).length===0?null:n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Campaign Questions"}),n.jsx("div",{className:"space-y-4",children:Object.entries(x).map(([w,_])=>_&&typeof _=="object"&&_.question&&_.answer?n.jsxs("div",{className:"border-b border-gray-200 pb-4 last:border-b-0 last:pb-0",children:[n.jsx("dt",{className:"text-sm font-semibold text-gray-700 mb-1",dir:"auto",children:_.question}),n.jsx("dd",{className:"text-gray-900",dir:"auto",children:_.answer})]},w):n.jsxs("div",{className:"border-b border-gray-200 pb-4 last:border-b-0 last:pb-0",children:[n.jsx("dt",{className:"text-sm font-semibold text-gray-700 mb-1",dir:"auto",children:w.replace(/_/g," ").replace(/\b\w/g,P=>P.toUpperCase())}),n.jsx("dd",{className:"text-gray-900",dir:"auto",children:typeof _=="object"?JSON.stringify(_):String(_)})]},w))})]})}catch(x){return console.error("Error parsing custom_fields:",x),null}})(),n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Notes & Activity"}),n.jsxs("form",{onSubmit:re,className:"mb-6",children:[n.jsx("textarea",{value:g,onChange:x=>h(x.target.value),placeholder:"Add a note about this lead...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b}),n.jsx("div",{className:"mt-2 flex justify-end",children:n.jsx("button",{type:"submit",disabled:b||!g.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Adding...":"Add Note"})})]}),n.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2 custom-scrollbar",children:i.length===0?n.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:n.jsx("p",{className:"text-gray-500",children:"No notes yet. Start the conversation!"})}):i.map(x=>{const w=x.user_id===r?.id;return n.jsxs("div",{className:`flex gap-3 ${w?"flex-row-reverse":""}`,children:[n.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${w?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:x.user_name?x.user_name.charAt(0).toUpperCase():"U"}),n.jsxs("div",{className:`flex flex-col max-w-[80%] ${w?"items-end":"items-start"}`,children:[n.jsx("div",{className:`rounded-lg p-3 ${w?"bg-blue-50 text-blue-900 rounded-tr-none":"bg-gray-50 text-gray-900 rounded-tl-none"}`,children:n.jsx("p",{className:"whitespace-pre-wrap text-sm",children:x.note_text})}),n.jsxs("span",{className:"text-xs text-gray-400 mt-1",children:[x.user_name||r?.display_name," â€¢ ",$(x.created_at)]})]})]},x.id)})})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Activity Log"}),n.jsx("div",{className:"space-y-3",children:c.length===0?n.jsx("p",{className:"text-gray-500 text-center py-4",children:"No activity yet"}):c.map(x=>n.jsx("div",{className:"flex gap-3 border-l-2 border-blue-200 pl-4 py-2",children:n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium text-gray-900",children:x.user_name||"System"}),n.jsx("span",{className:"text-xs text-gray-500",children:$(x.created_at)})]}),n.jsx("p",{className:"text-sm text-gray-700",children:x.event_name||x.event_type}),x.payload&&Object.keys(x.payload).length>0&&n.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:[x.payload.old_status&&x.payload.new_status&&n.jsxs("span",{children:["Status: ",x.payload.old_status," â†’ ",x.payload.new_status]}),x.payload.assigned_to&&n.jsxs("span",{children:["Assigned to: ",x.payload.assigned_to]}),x.event_name==="file_uploaded"&&x.payload.file_name&&n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:"text-gray-600",children:"Uploaded:"}),n.jsx("span",{className:"font-medium text-blue-600",children:x.payload.file_name}),x.payload.dropbox_path&&n.jsxs("span",{className:"text-xs text-gray-400",children:["(",x.payload.dropbox_path,")"]})]})]})]})},x.id))})]})]})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Update Status"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("select",{value:v,onChange:x=>R(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:T,children:[n.jsx("option",{value:"pending",children:"Pending"}),n.jsx("option",{value:"contacted",children:"Contacted"}),n.jsx("option",{value:"qualified",children:"Qualified"}),n.jsx("option",{value:"converted",children:"Converted"}),n.jsx("option",{value:"lost",children:"Lost"})]}),n.jsx("button",{onClick:ne,disabled:T||v===s.status_code,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:T?"Updating...":"Update Status"})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),n.jsxs("div",{className:"space-y-2",children:[s.email&&n.jsx("a",{href:`mailto:${s.email}`,className:"block w-full px-4 py-2 text-center border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Send Email"}),s.phone&&n.jsx("a",{href:`tel:${s.phone}`,className:"block w-full px-4 py-2 text-center border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Call Lead"}),n.jsxs("button",{onClick:()=>f("whatsapp"),className:"block w-full px-4 py-2 text-center border border-green-500 text-green-600 rounded-md hover:bg-green-50 flex items-center justify-center gap-2",children:[n.jsx("span",{className:"text-lg",children:"ðŸ’¬"})," Open WhatsApp Chat"]}),n.jsxs("div",{className:"pt-4 border-t border-gray-200 mt-4",children:[n.jsxs("label",{className:`flex items-center justify-center w-full px-4 py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-500 hover:text-blue-600 hover:bg-blue-50 transition-colors cursor-pointer ${C?"opacity-50 cursor-not-allowed":""}`,children:[C?n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Upload Screenshot"]}),n.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:J,disabled:C})]}),n.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"Upload chat screenshots for the record"})]})]})]})]})]})]})})]})}export{Ir as default};
