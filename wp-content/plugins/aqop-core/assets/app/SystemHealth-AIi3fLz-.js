import{c as u,j as e}from"./query-vendor-CG4xf7JE.js";import{r as w}from"./react-vendor-Ch0kAUMy.js";import{c as l,b,u as k,L as S,S as C}from"./index-DcCoICHm.js";import{N as L,A as _}from"./Navigation-B2sBVjrF.js";import{T as p,C as A}from"./triangle-alert-oPdxbqhj.js";import{R as x,A as B,C as m,X as h,Y as y,T as g,a as D,B as E,b as z}from"./ui-vendor-DXE-MSi7.js";const q=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],M=l("circle-x",q);const H=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],$=l("database",H);const K=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],R=l("hard-drive",K);const T=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],F=l("refresh-cw",T);const I=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],O=l("server",I);const P=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],X=l("table",P),G=async()=>(await b.get("/aqop/v1/system/health")).data,V=async(s=7)=>(await b.get("/aqop/v1/system/stats",{params:{days:s}})).data,d={all:["system"],health:()=>[...d.all,"health"],stats:s=>[...d.all,"stats",s]},W=(s={})=>u({queryKey:d.health(),queryFn:G,refetchInterval:3e4,...s}),Y=(s=7,a={})=>u({queryKey:d.stats(s),queryFn:()=>V(s),keepPreviousData:!0,...a}),j=({status:s,message:a})=>{const r={ok:"bg-green-100 text-green-800 border-green-200",error:"bg-red-100 text-red-800 border-red-200",warning:"bg-yellow-100 text-yellow-800 border-yellow-200"},t={ok:e.jsx(A,{className:"w-4 h-4 mr-1"}),error:e.jsx(M,{className:"w-4 h-4 mr-1"}),warning:e.jsx(p,{className:"w-4 h-4 mr-1"})};return e.jsxs("div",{className:`flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${r[s]||r.warning}`,children:[t[s]||t.warning,a||s]})},o=({name:s,icon:a,data:r})=>r?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 transition-all duration-200 hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(a,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"font-semibold text-gray-900",children:s})]}),e.jsx(j,{status:r.status,message:r.message})]}),e.jsxs("div",{className:"text-xs text-gray-500 flex justify-between items-center mt-4 pt-4 border-t border-gray-50",children:[e.jsx("span",{children:"Last Checked:"}),e.jsx("span",{className:"font-mono",children:r.last_checked||"Never"})]})]}):null;function te(){const{user:s}=k(),[a,r]=w.useState(7),{data:t,isLoading:f,refetch:v}=W(),{data:n,isLoading:N}=Y(a);if(f||N)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(S,{size:"lg",text:"Analyzing system health..."})});const c=n?.daily_trends?.map(i=>({date:new Date(i.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),count:parseInt(i.count),type:i.event_name}))||[];return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(L,{currentPage:"system-health"}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 tracking-tight",children:"System Health"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Real-time monitoring and integration status"})]}),e.jsxs("button",{onClick:()=>v(),className:"flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Refresh Status"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-green-50 rounded-full opacity-50 blur-xl"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Database Latency"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:[t?.database?.latency,"ms"]})]}),e.jsx("div",{className:`p-2 rounded-lg ${t?.database?.status==="ok"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`,children:e.jsx($,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"mt-4 flex items-center text-sm",children:e.jsx(j,{status:t?.database?.status,message:t?.database?.message})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-blue-50 rounded-full opacity-50 blur-xl"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Async Jobs"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:t?.queue?.count})]}),e.jsx("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:e.jsx(O,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:"Pending background tasks"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-purple-50 rounded-full opacity-50 blur-xl"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Events Today"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:n?.events_today})]}),e.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-lg",children:e.jsx(_,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"mt-4 text-sm text-green-600 flex items-center",children:[e.jsx("span",{className:"flex h-2 w-2 rounded-full bg-green-500 mr-2"}),"System Active"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-red-50 rounded-full opacity-50 blur-xl"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Errors (24h)"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:n?.errors_24h})]}),e.jsx("div",{className:`p-2 rounded-lg ${n?.errors_24h>0?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:e.jsx(p,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:"Critical issues requiring attention"})]})]}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Integration Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(o,{name:"Airtable Sync",icon:X,data:t?.airtable}),e.jsx(o,{name:"Telegram Bot",icon:C,data:t?.telegram}),e.jsx(o,{name:"Dropbox Storage",icon:R,data:t?.dropbox})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"System Activity"}),e.jsxs("select",{value:a,onChange:i=>r(parseInt(i.target.value)),className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:7,children:"Last 7 Days"}),e.jsx("option",{value:14,children:"Last 14 Days"}),e.jsx("option",{value:30,children:"Last 30 Days"})]})]}),e.jsx("div",{className:"h-80",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(B,{data:c,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorCount",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]})}),e.jsx(m,{strokeDasharray:"3 3",vertical:!1,stroke:"#E5E7EB"}),e.jsx(h,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fill:"#6B7280",fontSize:12},dy:10}),e.jsx(y,{axisLine:!1,tickLine:!1,tick:{fill:"#6B7280",fontSize:12}}),e.jsx(g,{contentStyle:{backgroundColor:"#fff",borderRadius:"8px",border:"1px solid #E5E7EB",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},itemStyle:{color:"#111827",fontWeight:600}}),e.jsx(D,{type:"monotone",dataKey:"count",stroke:"#3B82F6",strokeWidth:2,fillOpacity:1,fill:"url(#colorCount)"})]})})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Event Distribution"}),e.jsx("div",{className:"h-80",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(E,{data:c,layout:"vertical",children:[e.jsx(m,{strokeDasharray:"3 3",horizontal:!0,vertical:!1,stroke:"#E5E7EB"}),e.jsx(h,{type:"number",hide:!0}),e.jsx(y,{dataKey:"type",type:"category",width:150,tick:{fill:"#4B5563",fontSize:12}}),e.jsx(g,{cursor:{fill:"transparent"}}),e.jsx(z,{dataKey:"count",fill:"#8B5CF6",radius:[0,4,4,0],barSize:20})]})})})]})]})]})})]})}export{te as default};
