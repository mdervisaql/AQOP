import{j as e}from"./query-vendor-CG4xf7JE.js";import{r as d}from"./react-vendor-Ch0kAUMy.js";import{N as U}from"./Navigation-B2sBVjrF.js";import{L as I,b as V}from"./index-DcCoICHm.js";import{l as Y}from"./leads-CQ_k3CbU.js";import{R as h,A as G,C as v,X as f,Y as y,T as u,L as b,a as _,B as R,b as w,c as A,P as H,d as X,e as J,f as T}from"./ui-vendor-DXE-MSi7.js";const Z=async(a={})=>{const j=new URLSearchParams(a).toString(),N=j?`/aqop/v1/analytics/detailed?${j}`:"/aqop/v1/analytics/detailed";return await V.get(N)};function ce(){const[a,j]=d.useState(null),[N,k]=d.useState(!0),[m,S]=d.useState("30days"),[c,C]=d.useState({start:"",end:""}),[ee,M]=d.useState([]),[te,se]=d.useState([]),[o,P]=d.useState([]),[x,D]=d.useState({}),[l,F]=d.useState({key:"conversionRate",direction:"desc"}),B=[{value:"today",label:"Today"},{value:"yesterday",label:"Yesterday"},{value:"7days",label:"Last 7 Days"},{value:"30days",label:"Last 30 Days"},{value:"thisweek",label:"This Week"},{value:"lastweek",label:"Last Week"},{value:"thismonth",label:"This Month"},{value:"lastmonth",label:"Last Month"},{value:"thisquarter",label:"This Quarter"},{value:"lastquarter",label:"Last Quarter"},{value:"thisyear",label:"This Year"},{value:"custom",label:"Custom Range"}];d.useEffect(()=>{$()},[m,c]);const $=async()=>{k(!0);try{const t={time_range:m};m==="custom"&&c.start&&c.end&&(t.start_date=c.start,t.end_date=c.end);const s=await Z(t);if(s.success&&s.data){const r=s.data;P(r.agent_performance||[]),D({timeSeries:r.time_trends||[],statusPie:r.status_distribution||[],sourcePie:r.source_breakdown||[],agentComparison:r.agent_performance?.slice(0,5)||[]}),q(r.agent_performance||[])}const n=await Y();n.success&&n.data&&j(n.data)}catch(t){console.error("Error fetching analytics:",t)}finally{k(!1)}},q=t=>{const n=[...t].sort((r,i)=>i.conversion_rate-r.conversion_rate).slice(0,10).map(r=>({name:r.name,total:r.total_leads,converted:r.converted,conversionRate:`${r.conversion_rate}%`,contactRate:`${r.contact_rate}%`}));M(n)},K=()=>!a||a.total_leads===0?0:(a.converted_leads/a.total_leads*100).toFixed(1),W=()=>!a||a.total_leads===0?0:((a.contacted_leads+a.qualified_leads+a.converted_leads)/a.total_leads*100).toFixed(1),z=()=>!a||a.total_leads===0?0:((a.qualified_leads+a.converted_leads)/a.total_leads*100).toFixed(1),E=()=>"+12.5%",O=()=>"2.3 hours",p=t=>{let s="asc";l.key===t&&l.direction==="asc"&&(s="desc"),F({key:t,direction:s})},L=()=>{const t=[...o];return t.sort((s,n)=>s[l.key]<n[l.key]?l.direction==="asc"?-1:1:s[l.key]>n[l.key]?l.direction==="asc"?1:-1:0),t},Q=()=>{const t=[["Agent Name","Total Leads","Contacted","Qualified","Converted","Conversion Rate","Contact Rate","This Month","This Month Rate"],...L().map(i=>[i.name,i.totalLeads,i.contacted,i.qualified,i.converted,`${i.conversionRate}%`,`${i.contactRate}%`,i.thisMonth,`${i.thisMonthRate}%`])].map(i=>i.join(",")).join(`
`),s=new Blob([t],{type:"text/csv"}),n=window.URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download=`agent-performance-report-${new Date().toISOString().split("T")[0]}.csv`,r.click(),window.URL.revokeObjectURL(n)},g=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"];return N?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(I,{size:"lg",text:"Loading analytics..."})}):e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(U,{currentPage:"analytics"}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Advanced Analytics Dashboard"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Comprehensive performance metrics and interactive insights"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timeRange",className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Range"}),e.jsx("select",{id:"timeRange",value:m,onChange:t=>S(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:B.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),m==="custom"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"From"}),e.jsx("input",{type:"date",id:"startDate",value:c.start,onChange:t=>C({...c,start:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"To"}),e.jsx("input",{type:"date",id:"endDate",value:c.end,onChange:t=>C({...c,end:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total Leads"}),e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a?.total_leads||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"All leads in system"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Conversion Rate"}),e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[K(),"%"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a?.converted_leads||0," converted"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Contact Rate"}),e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[W(),"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Successfully contacted"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Qualification Rate"}),e.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[z(),"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Qualified leads"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Avg Response Time"}),e.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:O()}),e.jsx("p",{className:"text-xs text-gray-500",children:"Time to contact"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Monthly Growth"}),e.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:E()}),e.jsx("p",{className:"text-xs text-gray-500",children:"Lead increase"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Leads Over Time"}),e.jsx("div",{className:"h-64",children:e.jsx(h,{width:"100%",height:"100%",children:e.jsxs(G,{data:x.timeSeries||[],children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(f,{dataKey:"date"}),e.jsx(y,{}),e.jsx(u,{}),e.jsx(b,{}),e.jsx(_,{type:"monotone",dataKey:"total",stackId:"1",stroke:"#8884d8",fill:"#8884d8",name:"Total Leads"}),e.jsx(_,{type:"monotone",dataKey:"converted",stackId:"2",stroke:"#82ca9d",fill:"#82ca9d",name:"Converted"})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Leads by Status"}),e.jsx("div",{className:"h-64",children:e.jsx(h,{width:"100%",height:"100%",children:e.jsxs(R,{data:x.statusPie||[],children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(f,{dataKey:"name"}),e.jsx(y,{}),e.jsx(u,{}),e.jsx(w,{dataKey:"value",fill:"#8884d8",children:(x.statusPie||[]).map((t,s)=>e.jsx(A,{fill:g[s%g.length]},`cell-${s}`))})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Leads by Source"}),e.jsx("div",{className:"h-64",children:e.jsx(h,{width:"100%",height:"100%",children:e.jsxs(H,{children:[e.jsx(X,{data:x.sourcePie||[],cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percentage:s})=>`${t}: ${s}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:(x.sourcePie||[]).map((t,s)=>e.jsx(A,{fill:g[s%g.length]},`cell-${s}`))}),e.jsx(u,{})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Agents Performance"}),e.jsx("div",{className:"h-64",children:e.jsx(h,{width:"100%",height:"100%",children:e.jsxs(R,{data:x.agentComparison||[],layout:"horizontal",children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(f,{type:"number"}),e.jsx(y,{dataKey:"name",type:"category",width:80}),e.jsx(u,{}),e.jsx(b,{}),e.jsx(w,{dataKey:"total",fill:"#8884d8",name:"Total Leads"}),e.jsx(w,{dataKey:"converted",fill:"#82ca9d",name:"Converted"})]})})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversion Trends"}),e.jsx("div",{className:"h-64",children:e.jsx(h,{width:"100%",height:"100%",children:e.jsxs(J,{data:x.timeSeries||[],children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(f,{dataKey:"date"}),e.jsx(y,{}),e.jsx(u,{}),e.jsx(b,{}),e.jsx(T,{type:"monotone",dataKey:"total",stroke:"#8884d8",strokeWidth:2,name:"Total Leads"}),e.jsx(T,{type:"monotone",dataKey:"converted",stroke:"#82ca9d",strokeWidth:2,name:"Converted Leads"})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Agent Performance Breakdown"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Detailed performance metrics for all agents"})]}),e.jsxs("button",{onClick:Q,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]})]}),o.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No agent performance data available"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agent"}),e.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>p("total_leads"),children:["Total Leads",l.key==="total_leads"&&e.jsx("span",{className:"ml-1",children:l.direction==="asc"?"↑":"↓"})]}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contacted"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qualified"}),e.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>p("converted"),children:["Converted",l.key==="converted"&&e.jsx("span",{className:"ml-1",children:l.direction==="asc"?"↑":"↓"})]}),e.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>p("conversion_rate"),children:["Conv. Rate",l.key==="conversion_rate"&&e.jsx("span",{className:"ml-1",children:l.direction==="asc"?"↑":"↓"})]}),e.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>p("contact_rate"),children:["Contact Rate",l.key==="contact_rate"&&e.jsx("span",{className:"ml-1",children:l.direction==="asc"?"↑":"↓"})]}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Period Leads"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Period Rate"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L().map((t,s)=>e.jsxs("tr",{className:s<3?"bg-yellow-50":"",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:t.name.split(" ").map(n=>n[0]).join("").toUpperCase().slice(0,2)})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),s<3&&e.jsxs("div",{className:"text-xs text-yellow-600 font-medium",children:["Top Performer #",s+1]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:t.total_leads})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.contacted}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.total_leads>0?(t.contacted/t.total_leads*100).toFixed(1):0,"% of total"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-orange-600 font-medium",children:t.qualified}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.total_leads>0?(t.qualified/t.total_leads*100).toFixed(1):0,"% of total"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-semibold text-green-600",children:t.converted}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.total_leads>0?(t.converted/t.total_leads*100).toFixed(1):0,"% of total"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[t.conversion_rate,"%"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${Math.min(t.conversion_rate,100)}%`}})})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[t.contact_rate,"%"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${Math.min(t.contact_rate,100)}%`}})})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.period_leads}),e.jsx("div",{className:"text-xs text-gray-500",children:"leads in period"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-semibold text-purple-600",children:[t.period_rate,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"conversion rate"})]})]},t.name))})]})}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active Agents"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[o.length>0?(o.reduce((t,s)=>t+s.conversion_rate,0)/o.length).toFixed(1):0,"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Avg Conversion"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:o.reduce((t,s)=>t+s.total_leads,0)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Leads Assigned"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:o.reduce((t,s)=>t+s.converted,0)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Conversions"})]})]})]})]})})]})}export{ce as default};
